{% extends 'base.html.twig' %}
{% block title %}Tableau de bord - Date Parfaite
{% endblock %}

{% block body %}
	<div class="container-tableauBord">

		{% if app.user %}
			<div class="header">
				<img src="{{ asset('images/DateParfaite.png') }}" alt="Logo" class="logo-tableauBord">
				<h1>Bienvenue
					{{ app.user.prenom }}
					{{ app.user.nom }}</h1>
				<p>{{ app.user.email }}</p>
				<div class="btn-group">
					<a href="{{ path('reunion_new') }}" class="btn btn-planification">Nouvelle planification</a>
					<a href="{{ path('app_logout') }}" class="btn btn-deconnexion">Déconnexion</a>
				</div>
			</div>

			<h2>Mes Réunions</h2>
			<button class="toggle-btn" onclick="toggleAll()">Afficher / Masquer les réunions</button>

			<div id="reunions-section">
				{% for reunion in reunions %}
					<div class="reunion-item">
						<div class="reunion-info">
							<h3>{{ reunion.titre }}
								({{ reunion.status.value }})</h3>
							<p>{{ reunion.description }}<br><strong>Lieu :</strong>
								{{ reunion.lieu }}</p>
							<p>
								<strong>Créée le :</strong>
								{{ reunion.dateCreation|date('d/m/Y H:i') }}
							</p>

							<div class="reunion-actions">
								<a href="{{ path('reunion_confirm', { id: reunion.id }) }}" class="btn btn-confirmer">Confirmer</a>
								<a href="{{ path('reunion_cancel', { id: reunion.id }) }}" class="btn btn-annuler">Annuler</a>
								<a href="{{ path('reunion_edit', { id: reunion.id }) }}" class="btn btn-modifier">Modifier</a>
								<a href="{{ path('reunion_choix_creneau', { id: reunion.id }) }}" class="btn btn-choisir">Choisir le créneau final</a>
							</div>
						</div>

						<div class="reunion-reponses">
							<h4>Invitations et réponses</h4>
							<ul>
								{% for invitation in reunion.invitations %}
									<li>
										<strong>Email :</strong>
										{{ invitation.inviteEmail }}
										{% if invitation.reponses|length > 0 %}
											<ul>
												{% for reponse in invitation.reponses %}
													<li>
														{{ reponse.nom }}
														{{ reponse.prenom }}
														—
														<strong>Confirmée :</strong>
														{{ reponse.valider ? 'Oui' : 'Non' }}<br>
														{% if reponse.commentaires %}
															<em>Commentaire :</em>
															{{ reponse.commentaires }}
														{% endif %}
													</li>
												{% endfor %}
											</ul>
										{% else %}
											<em>Aucune réponse reçue.</em>
										{% endif %}
									</li>
								{% endfor %}
							</ul>
						</div>
					</div>
				{% else %}
					<p>Aucune réunion planifiée.</p>
				{% endfor %}
			</div>

			{% for message in app.flashes('success') %}
				<div class="alert alert-success">{{ message }}</div>
			{% endfor %}
		{% else %}
			<h1>Veuillez vous connecter pour accéder à votre tableau de bord.</h1>
			<a href="{{ path('app_login') }}">Se connecter</a>
			<p class="mt-3">Pas de compte ?
				<a href="{{ path('app_register') }}">Créer un compte</a>
			</p>
		{% endif %}
	</div>
{% endblock %}
{% block javascripts %}
  
   
{% endblock %}
{% block stylesheets %}
	
   
{% endblock %}
